<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pasto.AI | {{ titulo }}</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;500;800&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #0f172a; color: white; }
        .text-neon { color: #ccff00; text-shadow: 0 0 10px rgba(204, 255, 0, 0.5); }
        .bg-neon { background-color: #ccff00; color: black; }
        .border-neon { border-color: #ccff00; }
        .glass { background: rgba(15, 23, 42, 0.8); backdrop-filter: blur(10px); border-bottom: 1px solid rgba(255, 255, 255, 0.1); }
        .player-card { transition: all 0.3s ease; }
        .player-card:hover { transform: translateY(-5px); box-shadow: 0 10px 30px -10px rgba(204, 255, 0, 0.3); }
        .gradient-overlay { background: linear-gradient(to top, rgba(15, 23, 42, 1) 0%, rgba(15, 23, 42, 0) 100%); }
        
        /* Estilos para Brackets (Cuadros) */
        .match-container { display: flex; flex-direction: column; gap: 20px; padding: 20px; }
        .match-box { background: #1e293b; border: 1px solid #334155; border-radius: 10px; padding: 15px; display: flex; justify-content: space-between; align-items: center; }
        .vs-badge { background: #ccff00; color: black; font-weight: bold; padding: 2px 8px; border-radius: 4px; font-size: 0.8rem; }
    </style>
</head>
<body class="min-h-screen">

    <!-- NAV -->
    <nav class="fixed top-0 w-full z-50 glass">
        <div class="max-w-7xl mx-auto px-4">
            <div class="flex items-center justify-between h-16">
                <a href="#" class="flex items-center gap-2">
                    <i class="fa-solid fa-bolt text-neon text-xl"></i>
                    <span class="font-bold text-xl tracking-tight">PASTO.AI</span>
                </a>
                <div class="text-sm font-bold text-slate-400">
                    {{ titulo }}
                </div>
            </div>
        </div>
    </nav>

    <!-- CONTENIDO DINÁMICO -->
    <div class="pt-28 pb-10 px-4 max-w-7xl mx-auto">
        
        <!-- MODO 1: RANKING O INSCRIPCIÓN (Tarjetas) -->
        {% if modo == 'ranking' or modo == 'torneo_inscripcion' %}
            <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 md:gap-6">
                {% for jugador in jugadores %}
                <div class="player-card group relative h-80 rounded-2xl overflow-hidden cursor-pointer border {{ 'border-neon' if loop.index == 1 else 'border-white/10' }}">
                    <img src="https://ui-avatars.com/api/?name={{ jugador.name }}&background=random&size=512&bold=true" 
                         class="absolute inset-0 w-full h-full object-cover transition-transform duration-700 group-hover:scale-110" alt="">
                    
                    <div class="absolute top-3 left-3 {{ 'bg-neon' if loop.index == 1 else 'bg-slate-800/80 text-white' }} font-bold px-3 py-1 rounded-md text-xs shadow-lg flex items-center gap-1">
                        #{{ loop.index }}
                    </div>

                    <div class="absolute inset-0 gradient-overlay flex flex-col justify-end p-4">
                        <div class="transform transition-transform duration-300 translate-y-2 group-hover:translate-y-0">
                            <div class="flex justify-between items-end mb-1">
                                <h3 class="text-lg md:text-xl font-bold leading-tight text-white">{{ jugador.name }}</h3>
                                <div class="text-right">
                                    <span class="block text-2xl font-black text-neon">{{ jugador.elo }}</span>
                                    <span class="text-[10px] text-gray-400 uppercase tracking-widest">Puntos</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                {% endfor %}
                
                {% if jugadores|length == 0 %}
                    <div class="col-span-full text-center py-20 text-slate-500">
                        <i class="fa-solid fa-ghost text-4xl mb-4"></i>
                        <p>Aún no hay jugadores en esta lista.</p>
                    </div>
                {% endif %}
            </div>

        <!-- MODO 2: BRACKETS (Partidos en Juego) -->
        {% elif modo == 'torneo_brackets' %}
            <div class="match-container">
                <h2 class="text-2xl font-bold text-white mb-4 border-l-4 border-neon pl-3">Ronda 1</h2>
                
                {% for partido in partidos %}
                <div class="match-box">
                    <div class="flex items-center gap-3">
                        <div class="w-10 h-10 rounded-full bg-slate-700 overflow-hidden">
                            <img src="https://ui-avatars.com/api/?name=J1&background=random" class="w-full h-full">
                        </div>
                        <span class="text-lg font-bold text-white">Jugador ID {{ partido.player_1_id }}</span>
                    </div>
                    
                    <div class="vs-badge">VS</div>
                    
                    <div class="flex items-center gap-3">
                        <span class="text-lg font-bold text-white">Jugador ID {{ partido.player_2_id }}</span>
                        <div class="w-10 h-10 rounded-full bg-slate-700 overflow-hidden">
                            <img src="https://ui-avatars.com/api/?name=J2&background=random" class="w-full h-full">
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        {% endif %}

    </div>

    <!-- SCRIPT MÁGICO -->
    <script>
        const clubId = "{{ club_id }}"; 
        const protocol = window.location.protocol === 'https:' ? 'wss:' : 'ws:';
        const wsUrl = `${protocol}//${window.location.host}/ws/${clubId}`;
        const socket = new WebSocket(wsUrl);

        socket.onmessage = function(event) {
            if (event.data === "update") {
                location.reload();
            }
        };
        
        // Auto-recarga de seguridad cada 10s por si el socket falla
        setInterval(() => {
            console.log("Verificando conexión...");
        }, 10000);
    </script>

</body>
</html>